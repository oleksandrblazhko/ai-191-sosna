| Ідентифікатор та назва атаки (вразливості) | Вимога (FR,NFR) | Приклад вразливостей, які може використовувати атака | Приклад запобігання успішної реалізації атаки |
|:------------------------------------------:|:---------------:|:----------------------------------------------------:|:---------------------------------------------:|
| A1 – недоліки контролю доступу (Broken Access Control) | FR1 – Реєстрація та авторизація | Сценарій №1: програма використовує неперевірені дані у виклику SQL, який отримує доступ до інформації облікового запису, Сценарій №2: зловмисник просто змушує переглядати цільові URL-адреси. Для доступу до сторінки адміністратора потрібні права адміністратора. | -Застосуйте механізми контролю доступу один раз і повторно використовуйте їх у всій програмі, включно з мінімізацією спільного використання ресурсів між джерелами (CORS). -Контроль доступу моделі повинен забезпечувати право власності на запис, а не приймати, що користувач може створювати, читати, оновлювати або видаляти будь-який запис. | 
| A2 – невдачі (збої) у криптографії (Cryptographic Failures) | FR2 – 2. Пошук і купівля товару | Сценарій №1 : програма шифрує номери кредитних карток у базі даних за допомогою автоматичного шифрування бази даних. Однак ці дані автоматично розшифровуються під час отримання, дозволяючи помилці впровадження SQL отримати номери кредитних карток у відкритому вигляді. Сценарій №2 : сайт не використовує TLS або не підтримує TLS для всіх сторінок або підтримує слабке шифрування. Зловмисник відстежує мережевий трафік (наприклад, у незахищеній бездротовій мережі), знижує рівень підключень з HTTPS до HTTP, перехоплює запити та викрадає файл cookie сеансу користувача. Потім зловмисник повторно відтворює цей файл cookie та захоплює (автентифікований) сеанс користувача, отримуючи доступ або змінюючи особисті дані користувача. Замість вищезазначеного вони можуть змінити всі транспортовані дані, наприклад, одержувача грошового переказу. | - Класифікуйте дані, які обробляються, зберігаються або передаються програмою. Визначте, які дані є конфіденційними відповідно до законів про конфіденційність, нормативних вимог або потреб бізнесу. - Не зберігайте конфіденційні дані без потреби. Відмовтеся від нього якнайшвидше або скористайтеся сумісною з PCI DSS токенізацією чи навіть скороченням. Дані, які не зберігаються, не можуть бути викрадені. - Переконайтеся, що ви зашифрували всі конфіденційні дані в стані спокою |  
| A3 – впровадження (Injection) | FR2 – 3. Управління товарами і новинами | -Сценарій №1: програма використовує ненадійні дані для створення наступного вразливого виклику SQL, -Сценарій №2. Подібним чином сліпа довіра програми до фреймворків може призвести до запитів, які залишаються вразливими (наприклад, Hibernate Query Language (HQL)) | - Бажаним варіантом є використання безпечного API, який повністю уникає використання інтерпретатора, надає параметризований інтерфейс або переходить на інструменти відображення об’єктів (ORM). Примітка. Навіть якщо параметризовано, збережені процедури все одно можуть впроваджувати SQL-ін’єкції, якщо PL/SQL або T-SQL об’єднує запити та дані або виконує ворожі дані за допомогою EXECUTE IMMEDIATE або exec(). - Використовуйте позитивну перевірку введення на стороні сервера. Це не повний захист, оскільки для багатьох програм потрібні спеціальні символи, наприклад текстові області або API для мобільних програм. |
| A7 – помилки ідентифікації та аутентифікації (Identification and Authentication Failures) | NFR1 – одночасний доступ всіх користувачів, починаючи з 1 до 15 | Сценарій №1: підкидання облікових даних, тобто використання списків відомих паролів, є поширеною атакою. Припустімо, що програма не реалізує автоматичний захист від загроз або внесення облікових даних. У цьому випадку програму можна використовувати як оракул пароля, щоб визначити, чи облікові дані дійсні. Сценарій №2: більшість атак автентифікації відбуваються через постійне використання паролів як єдиного фактора. Вимоги до ротації паролів і складності, які розглядаються як найкращі практики, заохочують користувачів використовувати та повторно використовувати слабкі паролі. Організаціям рекомендовано припинити цю практику відповідно до NIST 800-63 і використовувати багатофакторну автентифікацію. | - Якщо це можливо, застосуйте багатофакторну автентифікацію, щоб запобігти автоматизованому підкиданню облікових даних, грубій форсації та атакам повторного використання вкрадених облікових даних. - Не надсилайте та не розгортайте облікові дані за замовчуванням, особливо для адміністраторів. |
| A5 – неправильна конфігурація безпеки (Security Misconfiguration) | NFR2 – Вимоги до даних безпеки | Сценарій №1: список каталогу не вимкнено на сервері. Зловмисник виявляє, що може просто перерахувати каталоги. Зловмисник знаходить і завантажує скомпільовані класи Java, декомпілює їх і виконує зворотне проектування для перегляду коду. Потім зловмисник знаходить серйозну ваду контролю доступу в програмі. Сценарій №3: конфігурація сервера додатків дозволяє повертати користувачам докладні повідомлення про помилки, наприклад, трасування стека. Це потенційно може виявити конфіденційну інформацію або базові недоліки, наприклад версії компонентів, які, як відомо, є вразливими. | - Мінімальна платформа без будь-яких непотрібних функцій, компонентів, документації та зразків. Видаліть або не встановлюйте функції та фреймворки, які не використовуються. - Сегментована архітектура програми забезпечує ефективне та безпечне розділення між компонентами або орендарями за допомогою сегментації, контейнеризації або хмарних груп безпеки (ACL).| 
| A8 – невдачі (збої) у забезпеченні цілісності програмного забезпечення та даних (Software and Data Integrity Failures)  | NFR3 – Вимоги для безперервної роботи сайту | Сценарій №1 Оновлення без підпису: багато домашніх маршрутизаторів, приставок, мікропрограми пристроїв тощо не перевіряють оновлення за допомогою підписаної мікропрограми. Непідписане мікропрограмне забезпечення стає все більшою мішенню для зловмисників і, як очікується, буде тільки погіршуватися. Це викликає серйозне занепокоєння, оскільки багато разів немає іншого механізму для виправлення, крім виправлення в майбутній версії та чекання, поки попередні версії застаріють Сценарій №2: зловмисне оновлення SolarWinds : національні держави, як відомо, атакують механізми оновлення, недавньою помітною атакою стала атака SolarWinds Orion. Компанія, яка розробляє програмне забезпечення, мала безпечні процеси створення та оновлення цілісності. Тим не менш, їх вдалося підірвати, і протягом кількох місяців фірма розповсюджувала цілеспрямоване шкідливе оновлення понад 18 000 організацій, близько 100 з яких постраждали. Це одне з наймасштабніших і найзначніших порушень такого характеру в історії. | - Використовуйте цифрові підписи або подібні механізми, щоб переконатися, що програмне забезпечення або дані походять з очікуваного джерела та не були змінені. - Переконайтеся, що бібліотеки та залежності, такі як npm або Maven, використовують надійні репозиторії. Якщо у вас вищий профіль ризику, подумайте про розміщення перевіреного внутрішнього завідомо справного сховища. |
