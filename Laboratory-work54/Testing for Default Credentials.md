### Testing for Default Credentials

#### Резюме
У наш час веб-програми часто використовують популярне програмне забезпечення з відкритим кодом або комерційне програмне забезпечення, яке можна встановити на серверах з мінімальною конфігурацією або налаштуванням адміністратором сервера. Крім того, багато апаратних пристроїв (наприклад, мережеві маршрутизатори та сервери баз даних) пропонують веб-конфігурацію або адміністративні інтерфейси.

Часто ці програми після встановлення не налаштовані належним чином, а облікові дані за замовчуванням, надані для початкової автентифікації та налаштування, ніколи не змінюються. Ці облікові дані за замовчуванням добре відомі тестувальникам проникнення та, на жаль, також зловмисникам, які можуть використовувати їх для отримання доступу до різних типів програм.

Крім того, у багатьох ситуаціях, коли в програмі створюється новий обліковий запис, генерується пароль за замовчуванням (з деякими стандартними характеристиками). Якщо цей пароль є передбачуваним і користувач не змінює його під час першого доступу, це може призвести до того, що зловмисник отримає несанкціонований доступ до програми.

Основну причину цієї проблеми можна визначити як:

- Недосвідчений ІТ-персонал, який не усвідомлює важливості зміни паролів за замовчуванням на встановлених компонентах інфраструктури або залишає пароль за замовчуванням для «легкості обслуговування».
- Програмісти, які залишають задні двері для легкого доступу та тестування своєї програми, а потім забувають їх видалити.
- Програми з вбудованими незнімними обліковими записами за замовчуванням із попередньо встановленими іменем користувача та паролем.
- Програми, які не змушують користувача змінювати облікові дані за замовчуванням після першого входу.
#### Цілі тесту
- Перелічіть програми для облікових даних за замовчуванням і перевірте, чи вони все ще існують.
- Перегляньте та оцініть нові облікові записи користувачів і перевірте, чи створено вони за умовчанням або шаблонами, які можна ідентифікувати.
#### Як тестувати
Тестування облікових даних за замовчуванням для звичайних програм
У тестуванні чорної скриньки тестувальник нічого не знає про програму та її базову інфраструктуру. Насправді це часто не відповідає дійсності, і деяка інформація про додаток відома. Ми припускаємо, що за допомогою методів, описаних у цьому Посібнику з тестування в розділі «Збір інформації» , ви визначили принаймні одну або кілька поширених програм, які можуть містити доступні адміністративні інтерфейси.

Коли ви визначили інтерфейс програми, наприклад веб-інтерфейс маршрутизатора Cisco або портал адміністратора WebLogic, переконайтеся, що відомі імена користувачів і паролі для цих пристроїв не призводять до успішної автентифікації. Для цього ви можете переглянути документацію виробника або, набагато простіше, ви можете знайти загальні облікові дані за допомогою пошукової системи або за допомогою одного із сайтів чи інструментів, перелічених у розділі «Довідка».

Коли ми стикаємося з програмами, у яких немає списку облікових записів за замовчуванням і звичайних облікових записів користувачів (наприклад, через те, що програма не є широко поширеною), ми можемо спробувати вгадати дійсні облікові дані за замовчуванням. Зауважте, що в програмі, яка тестується, може бути ввімкнено політику блокування облікового запису, і багаторазові спроби підбору пароля з відомим іменем користувача можуть призвести до блокування облікового запису. Якщо обліковий запис адміністратора можна заблокувати, для системного адміністратора може бути проблематично скинути його.

Багато програм мають докладні повідомлення про помилки, які інформують користувачів сайту про дійсність введених імен користувачів. Ця інформація буде корисною під час перевірки облікових записів користувачів за замовчуванням або вгадування. Таку функцію можна знайти, наприклад, на сторінці входу, скидання пароля та сторінці забутого пароля та сторінці реєстрації. Знайшовши ім’я користувача за замовчуванням, ви також можете почати вгадувати паролі для цього облікового запису.

Додаткову інформацію про цю процедуру можна знайти в наступних розділах:

- Тестування для перерахування користувачів і облікового запису користувача, який можна вгадати
- Тестування політики щодо слабких паролів .
Оскільки ці типи облікових даних за замовчуванням часто прив’язані до адміністративних облікових записів, ви можете діяти таким чином:

- Спробуйте такі імена користувачів: «admin», «administrator», «root», «system», «guest», «operator» або «super». Вони популярні серед системних адміністраторів і часто використовуються. Крім того, ви можете спробувати «qa», «test», «test1», «testing» тощо. Спробуйте будь-яку комбінацію вищевказаного в полях імені користувача та пароля. Якщо програма вразлива до перерахування імен користувачів, і вам вдалося успішно ідентифікувати будь-яке з наведених вище імен користувачів, спробуйте ввести паролі подібним чином. Крім того, спробуйте ввести порожній пароль або один із таких «пароль», «pass123», «password123», «admin» або «guest» із зазначеними вище обліковими записами або будь-якими іншими обліковими записами з переліку. Подальші перестановки вищезазначеного також можуть бути спробовані. Якщо ці паролі не вдаються, можливо, варто використати загальний список імен користувачів і паролів і спробувати кілька запитів до програми. Це, звичайно, можна записати в сценарій, щоб заощадити час.
- Адміністративні користувачі програми часто називаються на честь програми або організації. Це означає, що якщо ви тестуєте програму під назвою «Obscurity», спробуйте використовувати obscurity/obscurity або будь-яку іншу подібну комбінацію як ім’я користувача та пароль.
- Виконуючи тест для клієнта, спробуйте використовувати імена контактів, які ви отримали, як імена користувачів із будь-якими типовими паролями. Адреси електронної пошти клієнтів розкривають угоду про іменування облікових записів користувачів: якщо у співробітника «Джон Доу» є адреса електронної пошти jdoe@example.com, ви можете спробувати знайти імена системних адміністраторів у соціальних мережах і вгадати їхнє ім’я користувача, застосувавши ту саму угоду про іменування до їх імені.
- Спробуйте використати всі наведені вище імена користувачів із порожніми паролями.
- Перегляньте джерело сторінки та JavaScript через проксі-сервер або переглянувши джерело. Шукайте посилання на користувачів і паролі в джерелі. Наприклад If username='admin' then starturl=/admin.asp else /index.asp(для успішного входу проти невдалого входу). Крім того, якщо у вас є дійсний обліковий запис, увійдіть і перегляньте всі запити та відповіді на дійсний вхід і недійсний вхід, наприклад додаткові приховані параметри, цікавий запит GET (login=yes) тощо.
- Шукайте імена облікових записів і паролі, написані в коментарях у вихідному коді. Також шукайте в каталогах резервних копій вихідний код (або резервні копії вихідного коду), який може містити цікаві коментарі та код.
#### Тестування пароля за замовчуванням для нових облікових записів
Також може статися так, що коли в програмі створюється новий обліковий запис, йому призначається пароль за умовчанням. Цей пароль може мати деякі стандартні характеристики, що робить його передбачуваним. Якщо користувач не змінює його під час першого використання (це часто трапляється, якщо користувача не змушують змінити) або якщо користувач ще не ввійшов до програми, це може призвести до того, що зловмисник отримає неавторизований доступ до програми.

Наведені раніше поради щодо можливої ​​політики блокування та докладних повідомлень про помилки також застосовуються тут під час тестування паролів за замовчуванням.

Щоб перевірити ці типи облікових даних за замовчуванням, можна застосувати такі кроки:

- Перегляд сторінки реєстрації користувача може допомогти визначити очікуваний формат і мінімальну або максимальну довжину імен користувачів і паролів програми. Якщо сторінки реєстрації користувача не існує, визначте, чи використовує організація стандартну угоду про імена для імен користувачів, як-от адресу електронної пошти або ім’я перед електронним @листом.
- Спробуйте екстраполювати з програми, як генеруються імена користувачів. Наприклад, чи може користувач вибрати власне ім’я користувача чи система генерує ім’я облікового запису для користувача на основі певної особистої інформації чи використовуючи передбачувану послідовність? Якщо програма генерує імена облікових записів у передбачуваній послідовності, наприклад user7811, спробуйте рекурсивно виконати фаззінг усіх можливих облікових записів. Якщо ви можете визначити іншу відповідь від програми при використанні дійсного імені користувача та неправильного пароля, тоді ви можете спробувати атаку грубою силою на дійсне ім’я користувача (або швидко спробувати будь-який із визначених типових паролів вище або в довідковому розділі).
Спробуйте визначити, чи згенерований системою пароль є передбачуваним. Для цього створіть багато нових облікових записів швидко один за одним, щоб можна було порівняти та визначити, чи є паролі передбачуваними. Якщо передбачувано, спробуйте співвіднести їх з іменами користувачів або будь-якими перерахованими обліковими записами та використати їх як основу для атаки грубою силою.
- Якщо ви визначили правильний спосіб присвоєння імен для імені користувача, спробуйте створити паролі «грубою форсою» з якоюсь звичайною передбачуваною послідовністю, як-от дати народження.
- Спробуйте використати всі наведені вище імена користувачів із порожніми паролями або використати ім’я користувача також як значення пароля.
#### Тестування сірого ящика
Наступні кроки повністю спираються на підхід сірої скриньки. Якщо вам доступна лише частина цієї інформації, зверніться до тестування чорної скриньки, щоб заповнити прогалини.

- Поговоріть з ІТ-персоналом, щоб визначити, які паролі вони використовують для адміністративного доступу та як здійснюється адміністрування програми.
- Запитайте в ІТ-персоналу, чи змінено паролі за замовчуванням і чи вимкнено облікові записи користувачів за замовчуванням.
- Перевірте базу даних користувачів на наявність облікових даних за замовчуванням, як описано в розділі тестування чорної скриньки. Також перевірте наявність пустих полів пароля.
- Перевірте код на жорстко закодовані імена користувачів і паролі.
- Перевірте файли конфігурації, які містять імена користувачів і паролі.
- Перегляньте політику паролів і, якщо програма генерує власні паролі для нових користувачів, перевірте політику, яка використовується для цієї процедури.
#### Інструменти
- Burp Intruder
- ТГК Гідра
- Нікто 2
#### Список літератури
CIRT
